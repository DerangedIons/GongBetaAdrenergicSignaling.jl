
function X0 = getStartingState(modelCode)
% A function returning initial state for various models. Currently only 3
% variants are present, for endo/epi/midmyocardial TW, but futher ones
% may be added
y_Signaling= [0.00685533455220118,0.0184630401160325,0.000731426797266862,0.00746268345094940,0.0191020788696145,0.00115141961261304,0.000607348898749425,0.000639038753581265,0.000419992815346110,0.344257659177271,9.62262190945345,0.474028267773051,0.0148474493496437,0.203015985725400,0.00944459882156118,1.76916170568022e-10,8.36801924219387e-10,5.01719476559362e-11,0.0898875954193269,0.00272422687231002,0.225041998219388,0.0322381220102320,0.192803876209063,0.205457169881723,0.174050238959555,0.817148066343192,0.567236181979005,0.249911884364108,0.0646981828366729,0.0664977613514265,0.489057632872032,0.362107101574369,0.126950531297531,0.0233954992478800,0.0128401592747216,0.00629647926927854,4.29166115483698e-05,0.00917030613498568,0.0123536190564101,0.000664158274421826,0.000765842738691197,0.666165471397222,0.673477756497978,0.236980176272067,0.124710628782511,0.00404925913372347,0.0589106047787742,0.0274407333314977,6.32124571143896e-10,0.00159025206300466,0.00209267447556971,0.000502422412564797,0.0110248493074472,8.04005829146876e-11,0.000364313646402573,0.000705654325530757,0.000341340679127998];

if (strcmp(modelCode, 'TW_endo'))
    X0 = [-87.0655895407835	8.88424477947199	8.88341217642103	8.88365804124162	134.213097948672	9.20580586542242e-05	9.62428218317655e-05	9.66105402693763e-05	15.5745509675962	0.709622552333155	3.55888399344770	0.776467094025442	0.0104491410305814	0.124415836833344	0.00475139089328611	0.000326761159683871	0.00435725142843641	0.134587917639655	0.00247759889601234	0.00415486833433121	0.00810233315864154	0.0497605868295565	0.0960185900338078	1.32358809148372	0.00115997496446638	0.791660456106286	0.791587530878068	0.000224902633151066	0.478572465113524	0.258793079229038	0.000286101402392894	0.768184915918179	0.000286099374494750	0.999998646875180	0.000132590983159417	0.777117031645024	0.000132590043205027	0.999998646879750	0.0311875010014239	0.0312048105743730	0.997558791218494	0.000960122333286174	0.000804204051120587	0.000641292278097940	3.55901681542091e-05	6.00992839633468e-26	0.999999988243592	0.911094950010905	0.999999988251085	0.991477881027689	0.999993204834445	0.00528788208273223	0.00621547539490541	0.999999987868131	0.999999987980701	0.998342275864490	0.998263185911480	0.821525956842405	3.33929041065479e-08	4.57362306340243e-09	0.0653313479138348	0.821663945287200	5.00978004918837e-08	6.86118926495390e-09	0.0651828099424919	-9.23949112019061e-15	0.999994847409611	0.998725931920675	0.00191507884532543	0.00285370717430549	0.0319778784167468	0.992378492940848	0	0	0.0414775695414329	0.149310462149601	0.0583425856770706	0.0102519516890396	0.0414775695414004	0.612409807882460	0.791052149435449	0.00334028683421830	0.647375310489836	0.647279109941897	0.419158183843564	0.418669666153646	2.54912550780392e-35	0.999999987992091	0.930411822666439	0.999999987985882	0.999145398038995	0.999999987992091	0.999999987985882];
end

if (strcmp(modelCode, 'TW_epi'))
    X0 = [-87.1048524508679	8.90148132748262	8.90072358449787	8.90096864467852	134.012103188729	8.72548819699519e-05	9.34139871148849e-05	9.40800343669230e-05	15.3872615947250	0.698459164097118	3.56257543047284	0.777275105712417	0.0103554573272331	0.123882165390239	0.00491727634978175	0.000318295368582715	0.00417906366078184	0.134769347698577	0.00242099311501951	0.00393953676179554	0.00786577099883911	0.0477508386727348	0.0938266416524447	1.31355127027864	0.00115027134466251	0.792583130322282	0.792553752567347	0.000223231750796147	0.481102595159199	0.267345509289175	0.000285236054540071	0.752522034328527	0.000285235501415760	0.999998657484284	0.000132189884504471	0.774067457015800	0.000132189628125158	0.999998657485465	0.0310600216171209	0.0310792031421878	0.997802838380096	0.000957620596017843	0.000789240755687893	0.000426716358231017	2.35839847676158e-05	-3.46880270271892e-25	0.999999988370340	0.932289901059922	0.999999988369518	0.994178517822215	0.999996646216809	0.00435031097879067	0.00557704818434563	0.999999988329020	0.999999988404983	0.998428187084817	0.998315853586705	0.823517273398309	2.90937139756062e-08	3.95481946481633e-09	0.0639312650912837	0.823701418817511	4.36503652676116e-08	5.93309508583327e-09	0.0637332255847403	1.28906579067796e-15	0.999997489489555	0.999197380828516	0.00174833745653893	0.00261533326453387	0.0306395397966677	0.993021075755664	0	0	0.0392696034990402	0.143071459593468	0.0556754765249090	0.00997995964953318	0.0392696034990509	0.613818711143857	0.792257858985778	0.00331302654788553	0.648713522115395	0.648674807414497	0.420723521562499	0.420466953058846	2.54912550780392e-35	0.999999987992091	0.930411822666439	0.999999987985882	0.999145398038995	0.999999987992091	0.999999987985882];
end

if (strcmp(modelCode, 'TW_mid'))
    X0 = [-87.2384853115543	9.03486164883945	9.03398506758580	9.03421756239809	134.254374452400	7.90465278115845e-05	9.15679857304743e-05	9.35462933875863e-05	15.7679731855477	0.697731534031377	3.59054064670820	0.783353170323704	0.0103370187051519	0.124291404278596	0.00478686692988142	0.000316542860038368	0.00430734651181887	0.134635158144709	0.00240982892150671	0.00357118654357194	0.00771155734990443	0.0442003847256494	0.0924553506272177	1.31289133128325	0.00111783862023975	0.795689975108679	0.795599867951665	0.000217637295197271	0.482964664905836	0.255819163437600	0.000282323923270554	0.762142313529315	0.000282321253043875	0.999998692853702	0.000130840080996848	0.766473273728536	0.000130838843320319	0.999998692859505	0.0310652769393233	0.0310961278174770	0.997263643148072	0.000948162519180413	0.000812360394501925	0.000924903223639660	5.09313590436145e-05	-4.62837889760126e-25	0.999999988780511	0.885554724513234	0.999999988787860	0.987670211514893	0.999985513694234	0.00303131094180496	0.00518725372581456	0.999999988946544	0.999999987514589	0.998574966246223	0.998346792622347	0.828415744181835	2.38287995480668e-08	3.03863600786223e-09	0.0653114478163399	0.828558092012807	3.57493636238796e-08	4.55844613637806e-09	0.0651595665546025	-1.04614101985537e-14	0.999988245224691	0.997926588163709	0.00172780969441378	0.00257327660987223	0.0303761309095773	0.993126814910972	0	0	0.0407045983181499	0.147433924459299	0.0575364909100377	0.0101682882796353	0.0407045983181357	0.618580440584743	0.794839505565308	0.00322185211058249	0.653232878527891	0.653119150342112	0.426038857232569	0.425412159402626	2.54912550780392e-35	0.999999987992091	0.930411822666439	0.999999987985882	0.999145398038995	0.999999987992091	0.999999987985882];
end

if (strcmp(modelCode, 'TW_endo_sig'))
    X0 = [-87.0655895407835	8.88424477947199	8.88341217642103	8.88365804124162	134.213097948672	9.20580586542242e-05	9.62428218317655e-05	9.66105402693763e-05	15.5745509675962	0.709622552333155	3.55888399344770	0.776467094025442	0.0104491410305814	0.124415836833344	0.00475139089328611	0.000326761159683871	0.00435725142843641	0.134587917639655	0.00247759889601234	0.00415486833433121	0.00810233315864154	0.0497605868295565	0.0960185900338078	1.32358809148372	0.00115997496446638	0.791660456106286	0.791587530878068	0.000224902633151066	0.478572465113524	0.258793079229038	0.000286101402392894	0.768184915918179	0.000286099374494750	0.999998646875180	0.000132590983159417	0.777117031645024	0.000132590043205027	0.999998646879750	0.0311875010014239	0.0312048105743730	0.997558791218494	0.000960122333286174	0.000804204051120587	0.000641292278097940	3.55901681542091e-05	6.00992839633468e-26	0.999999988243592	0.911094950010905	0.999999988251085	0.991477881027689	0.999993204834445	0.00528788208273223	0.00621547539490541	0.999999987868131	0.999999987980701	0.998342275864490	0.998263185911480	0.821525956842405	3.33929041065479e-08	4.57362306340243e-09	0.0653313479138348	0.821663945287200	5.00978004918837e-08	6.86118926495390e-09	0.0651828099424919	-9.23949112019061e-15	0.999994847409611	0.998725931920675	0.00191507884532543	0.00285370717430549	0.0319778784167468	0.992378492940848	0	0	0.0414775695414329	0.149310462149601	0.0583425856770706	0.0102519516890396	0.0414775695414004	0.612409807882460	0.791052149435449	0.00334028683421830	0.647375310489836	0.647279109941897	0.419158183843564	0.418669666153646	2.54912550780392e-35	0.999999987992091	0.930411822666439	0.999999987985882	0.999145398038995	0.999999987992091	0.999999987985882];
    X0 = [X0, y_Signaling];
end

if (strcmp(modelCode, 'TW_epi_sig'))
    X0 = [-87.1048524508679	8.90148132748262	8.90072358449787	8.90096864467852	134.012103188729	8.72548819699519e-05	9.34139871148849e-05	9.40800343669230e-05	15.3872615947250	0.698459164097118	3.56257543047284	0.777275105712417	0.0103554573272331	0.123882165390239	0.00491727634978175	0.000318295368582715	0.00417906366078184	0.134769347698577	0.00242099311501951	0.00393953676179554	0.00786577099883911	0.0477508386727348	0.0938266416524447	1.31355127027864	0.00115027134466251	0.792583130322282	0.792553752567347	0.000223231750796147	0.481102595159199	0.267345509289175	0.000285236054540071	0.752522034328527	0.000285235501415760	0.999998657484284	0.000132189884504471	0.774067457015800	0.000132189628125158	0.999998657485465	0.0310600216171209	0.0310792031421878	0.997802838380096	0.000957620596017843	0.000789240755687893	0.000426716358231017	2.35839847676158e-05	-3.46880270271892e-25	0.999999988370340	0.932289901059922	0.999999988369518	0.994178517822215	0.999996646216809	0.00435031097879067	0.00557704818434563	0.999999988329020	0.999999988404983	0.998428187084817	0.998315853586705	0.823517273398309	2.90937139756062e-08	3.95481946481633e-09	0.0639312650912837	0.823701418817511	4.36503652676116e-08	5.93309508583327e-09	0.0637332255847403	1.28906579067796e-15	0.999997489489555	0.999197380828516	0.00174833745653893	0.00261533326453387	0.0306395397966677	0.993021075755664	0	0	0.0392696034990402	0.143071459593468	0.0556754765249090	0.00997995964953318	0.0392696034990509	0.613818711143857	0.792257858985778	0.00331302654788553	0.648713522115395	0.648674807414497	0.420723521562499	0.420466953058846	2.54912550780392e-35	0.999999987992091	0.930411822666439	0.999999987985882	0.999145398038995	0.999999987992091	0.999999987985882];
    X0 = [X0, y_Signaling];
end

if (strcmp(modelCode, 'TW_mid_sig'))
    X0 = [-87.2384853115543	9.03486164883945	9.03398506758580	9.03421756239809	134.254374452400	7.90465278115845e-05	9.15679857304743e-05	9.35462933875863e-05	15.7679731855477	0.697731534031377	3.59054064670820	0.783353170323704	0.0103370187051519	0.124291404278596	0.00478686692988142	0.000316542860038368	0.00430734651181887	0.134635158144709	0.00240982892150671	0.00357118654357194	0.00771155734990443	0.0442003847256494	0.0924553506272177	1.31289133128325	0.00111783862023975	0.795689975108679	0.795599867951665	0.000217637295197271	0.482964664905836	0.255819163437600	0.000282323923270554	0.762142313529315	0.000282321253043875	0.999998692853702	0.000130840080996848	0.766473273728536	0.000130838843320319	0.999998692859505	0.0310652769393233	0.0310961278174770	0.997263643148072	0.000948162519180413	0.000812360394501925	0.000924903223639660	5.09313590436145e-05	-4.62837889760126e-25	0.999999988780511	0.885554724513234	0.999999988787860	0.987670211514893	0.999985513694234	0.00303131094180496	0.00518725372581456	0.999999988946544	0.999999987514589	0.998574966246223	0.998346792622347	0.828415744181835	2.38287995480668e-08	3.03863600786223e-09	0.0653114478163399	0.828558092012807	3.57493636238796e-08	4.55844613637806e-09	0.0651595665546025	-1.04614101985537e-14	0.999988245224691	0.997926588163709	0.00172780969441378	0.00257327660987223	0.0303761309095773	0.993126814910972	0	0	0.0407045983181499	0.147433924459299	0.0575364909100377	0.0101682882796353	0.0407045983181357	0.618580440584743	0.794839505565308	0.00322185211058249	0.653232878527891	0.653119150342112	0.426038857232569	0.425412159402626	2.54912550780392e-35	0.999999987992091	0.930411822666439	0.999999987985882	0.999145398038995	0.999999987992091	0.999999987985882];
    X0 = [X0, y_Signaling];
end


% Legacy starting states
if (strcmp(modelCode, 'human_V9'))
    y = [0.00110919838244676	0.990309119499148	0.993693393853476	0.0312893732466839	1.00067772693547	0.0250541375095119	0.0147637552482705	0.000287884481004259	0.763464843347036	0.000287874673800767	0.999998624883747	0.00852333011603757	0.0313867744029938	0.863448155384443	6.48971858955943e-08	8.99833657641310e-09	3.53918500269058	0.772194564766965	0.00877612371649453	0.122207014619576	0.00544667855248004	0.000289389753441532	0.00380273027256738	0.135151111508837	0.00213370869147277	0.00484083419184742	0.00804492675338549	0.0549402444413662	0.0978421967788812	1.42442638504381	0.787596216041561	8.79438225190557	8.79335365284649	8.79353643031957	134.385435166651	0.000114443087435670	8.66068441720742e-05	8.53966909920308e-05	-86.9854823647167	0.523350266127874	0.000228350580232889	0.468267132294638	4.19657436628991e-15	0.999999999965946	0.999999879495567	0.863454379353853	9.73457809876196e-08	1.34975128686093e-08	0.0167087809733021	0.0167024333719860	0.0478345710738695	0.166453691583166	0.0658114063452890	0.0546343296465223	0.000156194131630688	0.000235128869057516	0.00807763107171867	0.999373435811656	0	0	0.0478345710738695	0	0	0	0	0	0.997612043510410	0.000965655933938901	0.000805612891506524	0.000593610523709251	2.30768143211250e-05	0.999492377630316	0.636500882330003	15.6634847446002	2.54912550780392e-35	0.999999987992091	0.930411822666439	0.999999987985882	0.999145398038995	0.999995164969276	0.00569079538087870	0.00199858743701737	0.999999987510532	0.999999987913736	0.981448058123473	0.0185519418765186	0.984407684901855	0.0155923150981660];
    membrane_v = y(39);

    ions_na_junc = y(32);
    ions_na_sl = y(33);
    ions_na_i = y(34);
    ions_k_i = y(35);
    ions_ca_junc = y(36);
    ions_ca_sl = y(37);
    ions_ca_i = y(38);
    ions_cl_i = y(74);

    buffers_NaBj = y(17);
    buffers_NaBsl = y(18);
    buffers_TnClow = y(19);
    buffers_TnCHc = y(20);
    buffers_TnCHm = y(21);
    buffers_CaM = y(22);
    buffers_Myosin_ca = y(23);
    buffers_Myosin_mg = y(24);
    buffers_SRB = y(25);
    buffers_SLLj = y(26);
    buffers_SLLsl = y(27);
    buffers_SLHj = y(28);
    buffers_SLHsl = y(29);
    buffers_Csqn = y(30);
    ions_ca_SR = y(31);

    ina_m = y(1);
    ina_h = y(2);
    ina_j = y(3);
    inal_ml = y(41);
    inal_hl = y(42);
    inal_hl_p = y(42);

    ito_xtos = y(8);
    ito_ytos = y(9);
    ito_xtof = y(10);
    ito_ytof = y(11);
    ito_xtos_p = y(8);
    ito_ytos_p = y(9);
    ito_xtof_p = y(10);
    ito_ytof_p = y(11);

    iks_xs_junc = y(13);
    iks_xs_sl = y(4);

    ikr_c0 = y(67);
    ikr_c1 = y(68);
    ikr_c2 = y(69);
    ikr_o = y(70);
    ikr_i = y(71);

    ical_d=y(75);
    ical_ff=y(76);
    ical_fs=y(77);
    ical_fcaf=y(78);
    ical_fcas=y(79);
    ical_jca=y(80);
    ical_nca=y(81);
    ical_nca_i=y(82);
    ical_ffp=y(83);
    ical_fcafp=y(84);
    ical_pureCDI_junc = y(85);
    ical_pureCDI_sl = y(87);

    ryr_R = y(14);
    ryr_O = y(15);
    ryr_I = y(16);
    ryr_CaRI = y(49);
    ryr_R_p = y(46);
    ryr_O_p = y(47);
    ryr_I_p = y(48);
    ryr_CaRI_p = y(50);
    jrel_icaldep_act = y(43);
    jrel_icaldep_f1 = y(44);
    jrel_icaldep_f2 = y(45);

    contraction_XS=max(0,y(55));
    contraction_XW=max(0,y(56));
    contraction_Ca_TRPN=max(0,y(57));
    contraction_TmBlocked=y(58);
    contraction_ZETAS=y(59);
    contraction_ZETAW=y(60);

    camk_trap = y(51);
    camk_f_ICaL = y(52);
    camk_f_RyR = y(53);
    camk_f_PLB = y(54);
    ca_serca = y(54);

    X0 = [ membrane_v;
        ions_na_junc;
        ions_na_sl;
        ions_na_i;
        ions_k_i;
        ions_ca_junc;
        ions_ca_sl;
        ions_ca_i;
        ions_cl_i;
        ions_ca_SR;
        buffers_NaBj;
        buffers_NaBsl;
        buffers_TnClow;
        buffers_TnCHc;
        buffers_TnCHm;
        buffers_CaM;
        buffers_Myosin_ca;
        buffers_Myosin_mg;
        buffers_SRB;
        buffers_SLLj;
        buffers_SLLsl;
        buffers_SLHj;
        buffers_SLHsl;
        buffers_Csqn;
        ina_m;
        ina_h;
        ina_j;
        inal_ml;
        inal_hl;
        inal_hl_p;
        ito_xtos;
        ito_ytos;
        ito_xtof;
        ito_ytof;
        ito_xtos_p;
        ito_ytos_p;
        ito_xtof_p;
        ito_ytof_p;
        iks_xs_junc;
        iks_xs_sl;
        ikr_c0;
        ikr_c1;
        ikr_c2;
        ikr_o;
        ikr_i;
        ical_d;
        ical_ff;
        ical_fs;
        ical_fcaf;
        ical_fcas;
        ical_jca;
        ical_nca;
        ical_nca_i;
        ical_ffp;
        ical_fcafp;
        ical_pureCDI_junc;
        ical_pureCDI_sl;
        ryr_R;
        ryr_O;
        ryr_I;
        ryr_CaRI;
        ryr_R_p;
        ryr_O_p;
        ryr_I_p;
        ryr_CaRI_p;
        jrel_icaldep_act;
        jrel_icaldep_f1;
        jrel_icaldep_f2;
        contraction_XS;
        contraction_XW;
        contraction_Ca_TRPN;
        contraction_TmBlocked;
        contraction_ZETAS;
        contraction_ZETAW;
        camk_trap;
        camk_f_ICaL;
        camk_f_RyR;
        camk_f_PLB;
        ca_serca;
        ina_h;
        ina_j;
        ina_m;
        ina_h;
        ina_j;
        ina_h;
        ina_j;
        ical_d;
        ical_ff;
        ical_fs;
        ical_fcaf;
        ical_fcas;
        ical_ff;
        ical_fcaf];

    X0 = [X0];

end


if (strcmp(modelCode, 'human_V9sig'))
    y_Signaling= [0.00685533455220118,0.0184630401160325,0.000731426797266862,0.00746268345094940,0.0191020788696145,0.00115141961261304,0.000607348898749425,0.000639038753581265,0.000419992815346110,0.344257659177271,9.62262190945345,0.474028267773051,0.0148474493496437,0.203015985725400,0.00944459882156118,1.76916170568022e-10,8.36801924219387e-10,5.01719476559362e-11,0.0898875954193269,0.00272422687231002,0.225041998219388,0.0322381220102320,0.192803876209063,0.205457169881723,0.174050238959555,0.817148066343192,0.567236181979005,0.249911884364108,0.0646981828366729,0.0664977613514265,0.489057632872032,0.362107101574369,0.126950531297531,0.0233954992478800,0.0128401592747216,0.00629647926927854,4.29166115483698e-05,0.00917030613498568,0.0123536190564101,0.000664158274421826,0.000765842738691197,0.666165471397222,0.673477756497978,0.236980176272067,0.124710628782511,0.00404925913372347,0.0589106047787742,0.0274407333314977,6.32124571143896e-10,0.00159025206300466,0.00209267447556971,0.000502422412564797,0.0110248493074472,8.04005829146876e-11,0.000364313646402573,0.000705654325530757,0.000341340679127998];
    % like 8_3, but ina's h,j,h,j,h,j added at the end for the phoshporylations
    y = [0.00110919838244676	0.990309119499148	0.993693393853476	0.0312893732466839	1.00067772693547	0.0250541375095119	0.0147637552482705	0.000287884481004259	0.763464843347036	0.000287874673800767	0.999998624883747	0.00852333011603757	0.0313867744029938	0.863448155384443	6.48971858955943e-08	8.99833657641310e-09	3.53918500269058	0.772194564766965	0.00877612371649453	0.122207014619576	0.00544667855248004	0.000289389753441532	0.00380273027256738	0.135151111508837	0.00213370869147277	0.00484083419184742	0.00804492675338549	0.0549402444413662	0.0978421967788812	1.42442638504381	0.787596216041561	8.79438225190557	8.79335365284649	8.79353643031957	134.385435166651	0.000114443087435670	8.66068441720742e-05	8.53966909920308e-05	-86.9854823647167	0.523350266127874	0.000228350580232889	0.468267132294638	4.19657436628991e-15	0.999999999965946	0.999999879495567	0.863454379353853	9.73457809876196e-08	1.34975128686093e-08	0.0167087809733021	0.0167024333719860	0.0478345710738695	0.166453691583166	0.0658114063452890	0.0546343296465223	0.000156194131630688	0.000235128869057516	0.00807763107171867	0.999373435811656	0	0	0.0478345710738695	0	0	0	0	0	0.997612043510410	0.000965655933938901	0.000805612891506524	0.000593610523709251	2.30768143211250e-05	0.999492377630316	0.636500882330003	15.6634847446002	2.54912550780392e-35	0.999999987992091	0.930411822666439	0.999999987985882	0.999145398038995	0.999995164969276	0.00569079538087870	0.00199858743701737	0.999999987510532	0.999999987913736	0.981448058123473	0.0185519418765186	0.984407684901855	0.0155923150981660];
    membrane_v = y(39);

    ions_na_junc = y(32);
    ions_na_sl = y(33);
    ions_na_i = y(34);
    ions_k_i = y(35);
    ions_ca_junc = y(36);
    ions_ca_sl = y(37);
    ions_ca_i = y(38);
    ions_cl_i = y(74);

    buffers_NaBj = y(17);
    buffers_NaBsl = y(18);
    buffers_TnClow = y(19);
    buffers_TnCHc = y(20);
    buffers_TnCHm = y(21);
    buffers_CaM = y(22);
    buffers_Myosin_ca = y(23);
    buffers_Myosin_mg = y(24);
    buffers_SRB = y(25);
    buffers_SLLj = y(26);
    buffers_SLLsl = y(27);
    buffers_SLHj = y(28);
    buffers_SLHsl = y(29);
    buffers_Csqn = y(30);
    ions_ca_SR = y(31);

    ina_m = y(1);
    ina_h = y(2);
    ina_j = y(3);
    inal_ml = y(41);
    inal_hl = y(42);
    inal_hl_p = y(42); 

    ito_xtos = y(8);
    ito_ytos = y(9);
    ito_xtof = y(10);
    ito_ytof = y(11);
    ito_xtos_p = y(8);  
    ito_ytos_p = y(9); 
    ito_xtof_p = y(10); 
    ito_ytof_p = y(11); 

    iks_xs_junc = y(13);
    iks_xs_sl = y(4);

    ikr_c0 = y(67);
    ikr_c1 = y(68);
    ikr_c2 = y(69);
    ikr_o = y(70);
    ikr_i = y(71);

    ical_d=y(75);
    ical_ff=y(76);
    ical_fs=y(77);
    ical_fcaf=y(78);
    ical_fcas=y(79);
    ical_jca=y(80);
    ical_nca=y(81);
    ical_nca_i=y(82);
    ical_ffp=y(83);
    ical_fcafp=y(84);
    ical_pureCDI_junc = y(85);
    ical_pureCDI_sl = y(87);

    ryr_R = y(14);
    ryr_O = y(15);
    ryr_I = y(16);
    ryr_CaRI = y(49);
    ryr_R_p = y(46);
    ryr_O_p = y(47);
    ryr_I_p = y(48);
    ryr_CaRI_p = y(50);
    jrel_icaldep_act = y(43);
    jrel_icaldep_f1 = y(44);
    jrel_icaldep_f2 = y(45);

    contraction_XS=max(0,y(55));
    contraction_XW=max(0,y(56));
    contraction_Ca_TRPN=max(0,y(57));
    contraction_TmBlocked=y(58);
    contraction_ZETAS=y(59);
    contraction_ZETAW=y(60);

    camk_trap = y(51);
    camk_f_ICaL = y(52);
    camk_f_RyR = y(53);
    camk_f_PLB = y(54);
    ca_serca = y(54);

    X0 = [ membrane_v;

    ions_na_junc;
    ions_na_sl;
    ions_na_i;
    ions_k_i;
    ions_ca_junc;
    ions_ca_sl;
    ions_ca_i;
    ions_cl_i;
    ions_ca_SR;
    buffers_NaBj;
    buffers_NaBsl;
    buffers_TnClow;
    buffers_TnCHc;
    buffers_TnCHm;
    buffers_CaM;
    buffers_Myosin_ca;
    buffers_Myosin_mg;
    buffers_SRB;
    buffers_SLLj;
    buffers_SLLsl;
    buffers_SLHj;
    buffers_SLHsl;
    buffers_Csqn;
    ina_m;
    ina_h;
    ina_j;
    inal_ml;
    inal_hl;
    inal_hl_p;
    ito_xtos;
    ito_ytos;
    ito_xtof;
    ito_ytof;
    ito_xtos_p;
    ito_ytos_p;
    ito_xtof_p;
    ito_ytof_p;
    iks_xs_junc;
    iks_xs_sl;
    ikr_c0;
    ikr_c1;
    ikr_c2;
    ikr_o;
    ikr_i;
    ical_d;
    ical_ff;
    ical_fs;
    ical_fcaf;
    ical_fcas;
    ical_jca;
    ical_nca;
    ical_nca_i;
    ical_ffp;
    ical_fcafp;
    ical_pureCDI_junc;
    ical_pureCDI_sl;
    ryr_R;
    ryr_O;
    ryr_I;
    ryr_CaRI;
    ryr_R_p;
    ryr_O_p;
    ryr_I_p;
    ryr_CaRI_p;
    jrel_icaldep_act;
    jrel_icaldep_f1;
    jrel_icaldep_f2;
    contraction_XS;
    contraction_XW;
    contraction_Ca_TRPN;
    contraction_TmBlocked;
    contraction_ZETAS;
    contraction_ZETAW;
    camk_trap;
    camk_f_ICaL;
    camk_f_RyR;
    camk_f_PLB;
    ca_serca;
    ina_h;
    ina_j;
    ina_m;
    ina_h;
    ina_j;
    ina_h;
    ina_j;
    ical_d;
    ical_ff;
    ical_fs;
    ical_fcaf;
    ical_fcas;
    ical_ff;
    ical_fcaf];

    X0 = [X0; y_Signaling'];

end

end


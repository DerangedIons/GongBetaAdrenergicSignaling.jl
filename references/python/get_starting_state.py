import numpy as np


names = (
    "v",
    "na_junc",
    "na_sl",
    "na_i",
    "k_i",
    "ca_junc",
    "ca_sl",
    "ca_i",
    "cl_i",
    "ca_SR",
    "NaBj",
    "NaBsl",
    "TnClow",
    "TnCHc",
    "TnCHm",
    "CaM",
    "Myosin_ca",
    "Myosin_mg",
    "SRB",
    "SLLj",
    "SLLsl",
    "SLHj",
    "SLHsl",
    "Csqn",
    "m",
    "h",
    "j",
    "ml",
    "hl",
    "hl_p",
    "xtos",
    "ytos",
    "xtof",
    "ytof",
    "xtos_p",
    "ytos_p",
    "xtof_p",
    "ytof_p",
    "xs_junc",
    "xs_sl",
    "c0",
    "c1",
    "c2",
    "o",
    "i",
    "d",
    "ff",
    "fs",
    "fcaf",
    "fcas",
    "jca",
    "nca",
    "nca_i",
    "ffp",
    "fcafp",
    "pureCDI_junc",
    "pureCDI_sl",
    "R_ryr",
    "O",
    "I",
    "CaRI",
    "R_p",
    "O_p",
    "I_p",
    "CaRI_p",
    "jrel_icaldep_act",
    "jrel_icaldep_f1",
    "jrel_icaldep_f2",
    "XS",
    "XW",
    "Ca_TRPN",
    "TmBlocked",
    "ZETAS",
    "ZETAW",
    "trap",
    "f_ICaL",
    "f_RyR",
    "f_PLB",
    "serca_trap",
    "hp",
    "jp",
    "m_PKA",
    "h_PKA",
    "j_PKA",
    "h_dualP",
    "j_dualP",
    "d_P",
    "ff_P",
    "fs_P",
    "fcaf_P",
    "fcas_P",
    "fBPf",
    "fcaBPf",
)


def get_starting_state_signalling() -> np.ndarray:
    """
    Returns the common signaling state vector used in multiple models.
    """
    return np.array(
        [
            0.00685533455220118,
            0.0184630401160325,
            0.000731426797266862,
            0.00746268345094940,
            0.0191020788696145,
            0.00115141961261304,
            0.000607348898749425,
            0.000639038753581265,
            0.000419992815346110,
            0.344257659177271,
            9.62262190945345,
            0.474028267773051,
            0.0148474493496437,
            0.203015985725400,
            0.00944459882156118,
            1.76916170568022e-10,
            8.36801924219387e-10,
            5.01719476559362e-11,
            0.0898875954193269,
            0.00272422687231002,
            0.225041998219388,
            0.0322381220102320,
            0.192803876209063,
            0.205457169881723,
            0.174050238959555,
            0.817148066343192,
            0.567236181979005,
            0.249911884364108,
            0.0646981828366729,
            0.0664977613514265,
            0.489057632872032,
            0.362107101574369,
            0.126950531297531,
            0.0233954992478800,
            0.0128401592747216,
            0.00629647926927854,
            4.29166115483698e-05,
            0.00917030613498568,
            0.0123536190564101,
            0.000664158274421826,
            0.000765842738691197,
            0.666165471397222,
            0.673477756497978,
            0.236980176272067,
            0.124710628782511,
            0.00404925913372347,
            0.0589106047787742,
            0.0274407333314977,
            6.32124571143896e-10,
            0.00159025206300466,
            0.00209267447556971,
            0.000502422412564797,
            0.0110248493074472,
            8.04005829146876e-11,
            0.000364313646402573,
            0.000705654325530757,
            0.000341340679127998,
        ]
    )


def get_starting_state(model_code: str) -> dict[str, float]:
    """
    Returns the initial state vector (X0) for various cardiac cell models.

    This function is a Python conversion of a MATLAB script providing initial
    conditions for different electrophysiological models, including variants
    for endocardial, epicardial, and midmyocardial cells, with and without
    beta-adrenergic signaling pathways.

    Args:
        model_code (str): A string identifier for the desired model.
            Valid options include:
            - 'TW_endo', 'TW_epi', 'TW_mid'

    Returns:
        np.ndarray: A 1D NumPy array containing the initial state values for the
                    specified model.

    Raises:
        ValueError: If the provided model_code is not recognized.
    """
    # Common signaling state vector used in multiple models

    if model_code == "TW_endo":
        x0 = np.array(
            [
                -87.0655895407835,
                8.88424477947199,
                8.88341217642103,
                8.88365804124162,
                134.213097948672,
                9.20580586542242e-05,
                9.62428218317655e-05,
                9.66105402693763e-05,
                15.5745509675962,
                0.709622552333155,
                3.55888399344770,
                0.776467094025442,
                0.0104491410305814,
                0.124415836833344,
                0.00475139089328611,
                0.000326761159683871,
                0.00435725142843641,
                0.134587917639655,
                0.00247759889601234,
                0.00415486833433121,
                0.00810233315864154,
                0.0497605868295565,
                0.0960185900338078,
                1.32358809148372,
                0.00115997496446638,
                0.791660456106286,
                0.791587530878068,
                0.000224902633151066,
                0.478572465113524,
                0.258793079229038,
                0.000286101402392894,
                0.768184915918179,
                0.000286099374494750,
                0.999998646875180,
                0.000132590983159417,
                0.777117031645024,
                0.000132590043205027,
                0.999998646879750,
                0.0311875010014239,
                0.0312048105743730,
                0.997558791218494,
                0.000960122333286174,
                0.000804204051120587,
                0.000641292278097940,
                3.55901681542091e-05,
                6.00992839633468e-26,
                0.999999988243592,
                0.911094950010905,
                0.999999988251085,
                0.991477881027689,
                0.999993204834445,
                0.00528788208273223,
                0.00621547539490541,
                0.999999987868131,
                0.999999987980701,
                0.998342275864490,
                0.998263185911480,
                0.821525956842405,
                3.33929041065479e-08,
                4.57362306340243e-09,
                0.0653313479138348,
                0.821663945287200,
                5.00978004918837e-08,
                6.86118926495390e-09,
                0.0651828099424919,
                -9.23949112019061e-15,
                0.999994847409611,
                0.998725931920675,
                0.00191507884532543,
                0.00285370717430549,
                0.0319778784167468,
                0.992378492940848,
                0,
                0,
                0.0414775695414329,
                0.149310462149601,
                0.0583425856770706,
                0.0102519516890396,
                0.0414775695414004,
                0.612409807882460,
                0.791052149435449,
                0.00334028683421830,
                0.647375310489836,
                0.647279109941897,
                0.419158183843564,
                0.418669666153646,
                2.54912550780392e-35,
                0.999999987992091,
                0.930411822666439,
                0.999999987985882,
                0.999145398038995,
                0.999999987992091,
                0.999999987985882,
            ]
        )

    elif model_code == "TW_epi":
        x0 = np.array(
            [
                -87.1048524508679,
                8.90148132748262,
                8.90072358449787,
                8.90096864467852,
                134.012103188729,
                8.72548819699519e-05,
                9.34139871148849e-05,
                9.40800343669230e-05,
                15.3872615947250,
                0.698459164097118,
                3.56257543047284,
                0.777275105712417,
                0.0103554573272331,
                0.123882165390239,
                0.00491727634978175,
                0.000318295368582715,
                0.00417906366078184,
                0.134769347698577,
                0.00242099311501951,
                0.00393953676179554,
                0.00786577099883911,
                0.0477508386727348,
                0.0938266416524447,
                1.31355127027864,
                0.00115027134466251,
                0.792583130322282,
                0.792553752567347,
                0.000223231750796147,
                0.481102595159199,
                0.267345509289175,
                0.000285236054540071,
                0.752522034328527,
                0.000285235501415760,
                0.999998657484284,
                0.000132189884504471,
                0.774067457015800,
                0.000132189628125158,
                0.999998657485465,
                0.0310600216171209,
                0.0310792031421878,
                0.997802838380096,
                0.000957620596017843,
                0.000789240755687893,
                0.000426716358231017,
                2.35839847676158e-05,
                -3.46880270271892e-25,
                0.999999988370340,
                0.932289901059922,
                0.999999988369518,
                0.994178517822215,
                0.999996646216809,
                0.00435031097879067,
                0.00557704818434563,
                0.999999988329020,
                0.999999988404983,
                0.998428187084817,
                0.998315853586705,
                0.823517273398309,
                2.90937139756062e-08,
                3.95481946481633e-09,
                0.0639312650912837,
                0.823701418817511,
                4.36503652676116e-08,
                5.93309508583327e-09,
                0.0637332255847403,
                1.28906579067796e-15,
                0.999997489489555,
                0.999197380828516,
                0.00174833745653893,
                0.00261533326453387,
                0.0306395397966677,
                0.993021075755664,
                0,
                0,
                0.0392696034990402,
                0.143071459593468,
                0.0556754765249090,
                0.00997995964953318,
                0.0392696034990509,
                0.613818711143857,
                0.792257858985778,
                0.00331302654788553,
                0.648713522115395,
                0.648674807414497,
                0.420723521562499,
                0.420466953058846,
                2.54912550780392e-35,
                0.999999987992091,
                0.930411822666439,
                0.999999987985882,
                0.999145398038995,
                0.999999987992091,
                0.999999987985882,
            ]
        )

    elif model_code == "TW_mid":
        x0 = np.array(
            [
                -87.2384853115543,
                9.03486164883945,
                9.03398506758580,
                9.03421756239809,
                134.254374452400,
                7.90465278115845e-05,
                9.15679857304743e-05,
                9.35462933875863e-05,
                15.7679731855477,
                0.697731534031377,
                3.59054064670820,
                0.783353170323704,
                0.0103370187051519,
                0.124291404278596,
                0.00478686692988142,
                0.000316542860038368,
                0.00430734651181887,
                0.134635158144709,
                0.00240982892150671,
                0.00357118654357194,
                0.00771155734990443,
                0.0442003847256494,
                0.0924553506272177,
                1.31289133128325,
                0.00111783862023975,
                0.795689975108679,
                0.795599867951665,
                0.000217637295197271,
                0.482964664905836,
                0.255819163437600,
                0.000282323923270554,
                0.762142313529315,
                0.000282321253043875,
                0.999998692853702,
                0.000130840080996848,
                0.766473273728536,
                0.000130838843320319,
                0.999998692859505,
                0.0310652769393233,
                0.0310961278174770,
                0.997263643148072,
                0.000948162519180413,
                0.000812360394501925,
                0.000924903223639660,
                5.09313590436145e-05,
                -4.62837889760126e-25,
                0.999999988780511,
                0.885554724513234,
                0.999999988787860,
                0.987670211514893,
                0.999985513694234,
                0.00303131094180496,
                0.00518725372581456,
                0.999999988946544,
                0.999999987514589,
                0.998574966246223,
                0.998346792622347,
                0.828415744181835,
                2.38287995480668e-08,
                3.03863600786223e-09,
                0.0653114478163399,
                0.828558092012807,
                3.57493636238796e-08,
                4.55844613637806e-09,
                0.0651595665546025,
                -1.04614101985537e-14,
                0.999988245224691,
                0.997926588163709,
                0.00172780969441378,
                0.00257327660987223,
                0.0303761309095773,
                0.993126814910972,
                0,
                0,
                0.0407045983181499,
                0.147433924459299,
                0.0575364909100377,
                0.0101682882796353,
                0.0407045983181357,
                0.618580440584743,
                0.794839505565308,
                0.00322185211058249,
                0.653232878527891,
                0.653119150342112,
                0.426038857232569,
                0.425412159402626,
                2.54912550780392e-35,
                0.999999987992091,
                0.930411822666439,
                0.999999987985882,
                0.999145398038995,
                0.999999987992091,
                0.999999987985882,
            ]
        )

    else:
        raise ValueError(f"Model code '{model_code}' is not recognized.")

    return dict(zip(names, x0))
